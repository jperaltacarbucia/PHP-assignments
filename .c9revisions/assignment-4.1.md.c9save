{"ts":1379079279404,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":false,"ts":1379084683178,"patch":[[{"diffs":[[1,"function home()\n{\n    return isset($_SESSION['user_logged_in']) ? '\n    <p>\n      Hello, ' . $_SESSION['user_name'] . '. You are now logged in. Try to close\n      this browser tab and open it again. Still logged in! ;)\n    </p>\n    <p>\n      <a class=\"btn\" href=\"?a=logout\">Logout</a>\n    </p>' : login_form();\n}\n\nfunction logout()\n{\n    $_SESSION = array();\n    $_SESSION['msg'] = \"You are now logged out\";\n    header('Location: ' . $_SERVER['PHP_SELF']);\n    exit(); // TODO: should we really use exit() ?\n}\n\nfunction login()\n{\n    if (!empty($_POST)) {\n        $msg = '';\n        $user = read_user($_POST['user_name']);\n        if (isset($user['user_name'])) {\n            if (password_verify($_POST['user_password'], $user['user_password_hash'])) {\n                create_session($user);\n                header('Location: ' . $_SERVER['PHP_SELF']);\n                exit();\n            } else $msg = 'Wrong password';\n        } else $msg = 'User does not exist';\n        $_SESSION['msg'] = $msg;\n    }\n    return login_form();\n}\n\nfunction register()\n{\n    if (!empty($_POST)) {\n        $msg = '';\n        if ($_POST['user_name']) {\n            if ($_POST['user_password_new']) {\n                if ($_POST['user_password_new'] === $_POST['user_password_repeat']) {\n                    if (strlen($_POST['user_password_new']) > 5) {\n                        if (strlen($_POST['user_name']) < 65 && strlen($_POST['user_name']) > 1) {\n                            if (preg_match('/^[a-z\\d]{2,64}$/i', $_POST['user_name'])) {\n                                $user = read_user($_POST['user_name']);\n                                if (!isset($user['user_name'])) {\n                                    if ($_POST['user_email']) {\n                                        if (strlen($_POST['user_email']) < 65) {\n                                            if (filter_var($_POST['user_email'], FILTER_VALIDATE_EMAIL)) {\n                                                create_user();\n                                                $_SESSION['msg'] = 'You are now registered so please login';\n                                                header('Location: ' . $_SERVER['PHP_SELF']);\n                                                exit();\n                                            } else $msg = 'You must provide a valid email address';\n                                        } else $msg = 'Email must be less than 64 characters';\n                                    } else $msg = 'Email cannot be empty';\n                                } else $msg = 'Username already exists';\n                            } else $msg = 'Username must be only a-z, A-Z, 0-9';\n                        } else $msg = 'Username must be between 2 and 64 characters';\n                    } else $msg = 'Password must be at least 6 characters';\n                } else $msg = 'Passwords do not match';\n            } else $msg = 'Empty Password';\n        } else $msg = 'Empty Username';\n        $_SESSION['msg'] = $msg;\n    }\n    return register_form();\n}\n\n\n//The way He/She structured the code is good. He/She used appropiate names for the function,\n//which helps us know what the code is about and what is going to do. He/She should of used\n//comments to help a bit more on what the next set of codes is and what it does."]],"start1":0,"start2":0,"length1":0,"length2":3296}]],"length":3296,"saved":false}
{"contributors":[],"silentsave":false,"ts":1379087774076,"patch":[[{"diffs":[[0,"();\n}\n\n\n"],[1,"//REVIEW BY CLASSMATE\n"],[0,"//The wa"]],"start1":3023,"start2":3023,"length1":16,"length2":38},{"diffs":[[0,"it does."],[1,"\n//It looks like it's letting the user register for an account."]],"start1":3310,"start2":3310,"length1":8,"length2":71}]],"length":3381,"saved":false}
